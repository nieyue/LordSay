<!DOCTYPE html>
<html ng-app="mainApp" ng-controller="mainCtrl">
<head>
	<title ng-bind="backStageName"></title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
	<meta name="Keywords" content="系统，管理"/>
	<link rel="shortcut icon" href="http://img.newzhuan.cn/uploaderPath/img/20170907/15047652539005249544896312.png" />
	<link href="https://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
	 <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/metisMenu/2.7.1/metisMenu.min.css"/>
     <link href="/resources/css/sellerbase.css" rel="stylesheet">
	 <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/smalot-bootstrap-datetimepicker/2.4.4/css/bootstrap-datetimepicker.min.css"/>
</head>
   <body >
  	<div ui-view></div>
<!-- 按钮触发模态框 -->
<button class="hide" data-toggle="modal" 
   data-target="#myModal" id="mySellerModal">
</button>
	<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" 
   aria-labelledby="myModalLabel" aria-hidden="true">
   <div class="modal-dialog" >
      <div class="modal-content">
         <div class="modal-header">
            <button type="button" class="close" 
               data-dismiss="modal" aria-hidden="true" id="closeModal">
                  &times;
            </button>
            <h4 class="modal-title" id="mySellerModalLabel">
            </h4>
         </div>
         <div class="modal-body" id="mySellerModalBody">
         </div>
         <div class="modal-footer">
         	<div id="errorSellerInfo" class="text-justify text-danger"></div>
            <button type="button" class="btn btn-primary" id="sellerSubmit">
               提交
            </button>
         </div>
      </div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
		<script src="https://cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
		<script src="https://cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script src="https://cdn.bootcss.com/angular.js/1.5.7/angular.min.js"></script>
		<script src="https://cdn.bootcss.com/metisMenu/2.7.1/metisMenu.min.js"></script>
		<script src="https://cdn.bootcss.com/angular.js/1.5.7/angular-animate.min.js"></script>
		<script src="https://cdn.bootcss.com/angular-ui-router/0.4.3/angular-ui-router.min.js"></script>
		<!-- 
       <script src="/resources/js/bootstrap-datetimepicker.min.js"></script> 
		<script src="/resources/js/bootstrap-datetimepicker.zh-CN.js"></script>
		 -->
		 <script src="https://cdn.bootcss.com/smalot-bootstrap-datetimepicker/2.4.4/js/bootstrap-datetimepicker.min.js"></script> 
		<script src="https://cdn.bootcss.com/smalot-bootstrap-datetimepicker/2.4.4/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>
        <script src="https://cdn.bootcss.com/Sortable/1.6.0/Sortable.min.js"></script>
       <script src="/resources/js/base64.js"></script> 
       <script src="/resources/js/domainManager.js"></script> 
       <script src="/resources/js/base.js"></script> 
       <script type="text/javascript">
       var mainApp=angular.module('mainApp', ['ngAnimate','ui.router']);
        mainApp.directive('metis', function ($timeout) {
   		  return {
                restrict: 'A' ,
                link: function(scope, element, attrs) {
		           	 console.log(scope)
                     if (scope.$last==true) {
		           	 //$timeout(function () {
		           	 console.log("metis")
		               	  $('#leftBar').metisMenu();
		          		//  }, 250)
		       		 }
                    }
                    }
                    
		});
		mainApp.filter("bigNumber",function(){
                return function(bigNumber){
                if(bigNumber){
                bigNumber=Math.abs(bigNumber)>100000000?(bigNumber/100000000)+'亿':Math.abs(bigNumber)>10000?(bigNumber/10000)+'万':bigNumber;
                }
                 return bigNumber||0;
                }
            });
		mainApp.filter("bigDouble",function(){
                return function(bigDouble){
                if(bigDouble){
                bigDouble=Math.abs(bigDouble)>100000000?(bigDouble/100000000).toFixed(2)+'亿':Math.abs(bigDouble)>10000?(bigDouble/10000).toFixed(2)+'万':bigDouble;
                }
                 return bigDouble||0.0;
                }
            });
		
        mainApp.controller('mainCtrl', function($rootScope,$scope,$http) {
        //console.log=function(){};
         //验证是否已经登录
    		$.ajax({
    		url:"/acount/islogin",
    		async:false,  
    		success:function(data){
       			console.log(data)
       			if(data.code=='200'){
       			$rootScope.sessionAcount=data.list[0];
       			//$rootScope.$apply();
       			return;
       			}
       			location.replace("/seller/index.html");
       	}});
    	 //获取roleList
    		$.ajax({
    		url:"/role/list",
    		async:false,  
    		success:function(data){
       			if(data.code=='200'){
       			$rootScope.roleList=data.list;
       			//console.log($rootScope.roleList)
       			//$rootScope.$apply();
       			for(var i=0;i<$rootScope.roleList.length;i++){
       			//获取sessionRole
       			if($rootScope.roleList[i].roleId==$rootScope.sessionAcount.roleId){
       			$rootScope.sessionRole=$rootScope.roleList[i];
       			//获取新roleList
	       			if($rootScope.sessionRole.name!='超级管理员'){
	       			$rootScope.oldRoleList=$rootScope.roleList;
	       			$rootScope.roleList=[];
		       			for(var j=0;j<$rootScope.oldRoleList.length;j++){
		       				if($rootScope.oldRoleList[j].name!='超级管理员'){
	       					$rootScope.roleList.push($rootScope.oldRoleList[j]);
		       				
		       				}
		       			}
	       			}
       			}
       			}
       			return;
       			}
       			location.replace("/seller/index.html");
       	}});
   		//登录退出
   		$scope.sellerLoginOut=function(){
   			myUtils.myLoginOut("确定退出吗？", function(){
   				$.get("/acount/loginout",function(data){
   	   				if(data.code==200){
   	   					myUtils.myLoadingToast("退出成功", null);   	   				
   						location.replace("/seller/index.html");
   	   				}else{
   	   					myUtils.myLoadingToast("退出失败", null);   	   				
   	   				}
   	   			});
   			});
   		};
   		
       $scope.currentDate=myUtils.timeStampToDate(new Date());
       $scope.backstageName="抓你妹";//系统名称
       $scope.companyName="长沙嘉行煜发科技有限公司";//公司名称
       $rootScope.formDisabled=false;//表单提交，默认可以点击。
       $.ajaxSetup({
　　　　timeout: 10000,
	 // 将XHR对象的withCredentials设为true
	   xhrFields: {
	      withCredentials: true
	   },
　　　　//请求成功后触发
　　　　success: function (data) { $rootScope.formDisabled=false;},
　　　　//请求失败遇到异常触发
　　　　error: function (xhr, status, e) {$rootScope.formDisabled=false; },
　　　　//完成请求后触发。即在success或error触发后触发
　　　　complete: function (xhr, status) { 
	$rootScope.formDisabled=false; 
	},
　　　　//发送请求前触发
　　　　beforeSend: function (xhr) {
　　　　$rootScope.formDisabled=true;
	//没session
		if(!$rootScope.sessionAcount){
		location.replace("/seller/index.html");
		return false;
		}
　　　　},
　　});
    	 $rootScope.mainDomainUrl="http://"+domainManager.CatchSeconds;
    	 //$rootScope.mainDomainUrl="http://www.newzhuan.cn";
    	// $rootScope.mainDomainUrl="http://"+location.host;
    	 $rootScope.imgUploadDomain=domainManager.MyWangEditor;
    	//分享
    	$.ajax({
    		url:"/shareDomain/get",
    		async:false,  
    		success:function(data){
       			console.log(data)
       			if(data.code=='200'){
       			$rootScope.shareDomain=data.list[0].shareDomain;
       			//"头协议"+分享域名
         	$rootScope.shareDomainUrl="http://"+$rootScope.shareDomain;
       			//$rootScope.$apply();
       			return;
       			}
       	}});
       	//光明网
    	$.ajax({
    		url:"/gmwDomain/list",
    		async:false,  
    		success:function(data){
       			//console.log(data)
       			if(data.code=='200'){
       			$rootScope.gmwDomains=data.list;
       			//"头协议"+分享域名
         	$rootScope.gmwDomainUrl="http://"+$rootScope.gmwDomains[0];
       			//$rootScope.$apply();
       			return;
       			}
       	}});
    	$.ajax({
    		url:"/ssDomain/get",
    		async:false,  
    		success:function(data){
       			console.log(data)
       			if(data.code=='200'){
       			$rootScope.ssDomain=data.list[0].ssDomain;
       			//"头协议"+分享域名
         	$rootScope.ssDomainUrl="http://"+$rootScope.ssDomain;
       			return;
       			}
       	}});
    	 
    	  	
    	  	/*
            *横向滚动
            */
            $scope.tableWrapMove=function(direction){
            if(direction=='left'){
            $(".seller-main-body").scrollLeft(0);
            return;
            }
            if(direction=='right'){
             $(".seller-main-body").scrollLeft( 99999999);
            return;
            }
            };
            /*
            *横向滚动 end
            */
    	
   		//修改状态
   		$scope.updateAcountStatus=function(acount){
		myUtils.myLoginOut("确定修改吗？", function(){
       				$.get("/acount/update",
       				{
       				acountId:acount.acountId,
       				roleId:acount.roleId,
       				status:acount.status
       				},
       				function(data){
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("修改成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("修改失败");   	   				
       	   				}
       	   			});
       			});
	};
   		});
       mainApp.config(function ($stateProvider, $urlRouterProvider) {
     	$urlRouterProvider.when("", "main");
     	$stateProvider
     	.state("main", {
            url: "/main",
            views: {
                '': {
                    templateUrl: '/seller/templates/main.html'
                },
                'topbar@main': {
                    templateUrl: '/seller/templates/topbar.html'
                },
                'leftbar@main': {
                    templateUrl: '/seller/templates/leftbar.html',
                    controller:function($scope){
                    	myUtils.myClickRotate("a.toCaret","span.caret");//箭头旋转
                    	$(document).on("click","a",function(){
                    	$("a").removeClass("leftbar-active");
                    		$(this).addClass("leftbar-active");
                    	});
                    	 //leftBar
						$('#leftBar').metisMenu();
                    	
                    }
                } ,
                'rightbody@main': {
                    templateUrl: '/seller/templates/index.html',
                    controller:function($state){
                    	 $state.go("main.index");
                    }
                } 
            }
        })
         .state("main.index", {
            url:"/index",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/index.html",
                    controller:function($rootScope,$scope,$state){
                
                    }
                } 
            }
        })
         .state("main.noticeList", {//公告列表
            url:"/noticeList",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/notice_list.html",
                    controller:function($rootScope,$scope,$state){
                  
            /*
            *列表
            */
            $scope.noticeList=[]; 		
    		$scope.noMore=false;//false还有，true没有更多
    		$scope.totalNumber=0;//总管理员数目
 			$scope.showPageNumberArray=[];//显示页面循环的数组 类似 1,2,3,4,5
			$scope.totalPage=0;//总页数
				
			$scope.currentPage=1;//当前页
			$scope.pageNumber=10;//每页显示数目
			$scope.mostShowPageNumber=5;//设定最多显示页码数目	
			$scope.pagination=myUtils.myPaginationHandler();
			
			//点击哪页显示哪页
			$scope.toPage=function(currentPageNumber){
			  if($scope.pagination.toPage(currentPageNumber,$scope.currentPage,$scope.totalPage)){
			  $scope.currentPage=$scope.pagination.currentPage;
			  $scope.noticeListInit();
			  }
			};
			$scope.noticeListInit=function(){
			  $.get("/notice/count",function(cd){
           		$scope.totalNumber=cd;             
           //页码初始化
          $scope.totalPage=$scope.pagination.getTotalPage($scope.totalNumber,$scope.pageNumber);//总页码数目     
          $scope.showPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.mostShowPageNumber,$scope.currentPage);//显示页码数目 
          //所有页码
          $scope.showAllPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.totalPage,$scope.currentPage);
        //初始化
  $.get("/notice/list?pageNum="+(($scope.currentPage-1)*$scope.pageNumber+1)+"&pageSize="+$scope.pageNumber,function(pld){
           $scope.noticeList=pld;
			 console.log($scope.noticeList)
			$scope.$apply();
               });
       });
			};
			$scope.noticeListInit();
			/*
            *列表end
            */
			/*
            *修改
            */
            $scope.updateNotice=function(notice){
            $state.go("main.noticeUpdate",{noticeId:notice.noticeId});
            };
			/*
            *修改end
            */
			/*
            *删除
            */
            $scope.delNotice=function(notice){
            console.log($scope.showPageNumberArray)
            	myUtils.myLoginOut("确定删除吗？", function(){
       				$.get("/notice/delete?noticeId="+notice.noticeId,function(data){
       					console.log($scope.noticeList)
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("删除成功", function(){
       	   				location.reload();
       	   				}); 
       	   				
       	   				}else{
       	   					myUtils.myLoadingToast("删除失败");   	   				
       	   				}
       	   			});
       			});
            };
			/*
            *删除end
            */
                    }
                } 
            }
        })
         .state("main.noticeUpdate", {//公告更新
            url:"/noticeUpdate/:noticeId",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/notice_update.html",
                    controller:function($rootScope,$scope,$state){
                  	/*
            		*获取参数noticeId
            		*/
                    $scope.updateNoticeId=$state.params.noticeId;
                    console.log($scope.updateNoticeId)
                     if(!$scope.updateNoticeId||!myUtils.userVerification.catNum.test($scope.updateNoticeId)){
                    $state.go("main.noticeList");
                    return;
                    } 
                    /*
            		*获取参数noticeId end
            		*/
            		
            		/*
            		*初始化notice
            		*/
                    $scope.updateInit=function(noticeId){
                    $.get("/notice/"+noticeId,function(data){
       	   				if(data.code==200){
       	   				$scope.notice=data.list[0];
       	   				$scope.$apply();
       	   				myUtils.myLoadingToast("加载成功" ); 
       	   				}else{
       	   					myUtils.myLoadingToast("加载失败");   	   				
       	   				}
       	   			});
                    };
                    $scope.updateInit($scope.updateNoticeId);
                    /*
            		*初始化notice end
            		*/
            		 //上传文章封面图片
                 		$("#imgAddressFileUpload").change(function(){
                 			myUtils.fileUpload(
                 				    {inputfile:$("#imgAddressFileUpload"),
                 				    ajaxObj:{
                 				        formData:[
                 				            {key:"editorUpload",value:$("#imgAddressFileUpload").get(0).files[0]}
                 				            ],
                 				        url:"http://"+ $rootScope.imgUploadDomain+"/img/add",
                 				        success:function(data){
                 				            if(data){
                 				            myUtils.myPrevToast("上传成功",null,"remove");
                 				           $scope.notice.imgAddress=data;
                 				          $rootScope.formDisabled=false;
                 				            $scope.$apply();
                 				            }
                 				        }
                 				    }
                 				}
                 				);
                 		});
            		/*
            		*修改notice提交
            		*/
            		$scope.updateNoticeForm=function(){
            		$.post("/notice/update",
                    	JSON.parse(angular.toJson($scope.notice)),
                    	function(data){
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("修改成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("修改失败");   	   				
       	   				}
       	   				});
            		};
            		/*
            		*修改notice提交 end
            		*/
                    }
                } 
            }
        })
         .state("main.noticeAdd", {//公告增加
            url:"/noticeAdd",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/notice_add.html",
                    controller:function($rootScope,$scope,$state){
                     //上传文章封面图片
                 		$("#imgAddressFileUpload").change(function(){
                 			myUtils.fileUpload(
                 				    {inputfile:$("#imgAddressFileUpload"),
                 				    ajaxObj:{
                 				        formData:[
                 				            {key:"editorUpload",value:$("#imgAddressFileUpload").get(0).files[0]}
                 				            ],
                 				        url:"http://"+ $rootScope.imgUploadDomain+"/img/add",
                 				        success:function(data){
                 				            if(data){
                 				            myUtils.myPrevToast("上传成功",null,"remove");
                 				           $scope.notice.imgAddress=data;
                 				          $rootScope.formDisabled=false;
                 				            $scope.$apply();
                 				            }
                 				        }
                 				    }
                 				}
                 				);
                 		});
                    $scope.addNoticeForm=function(){
                    	$.post("/notice/add",
                    	{
                    	title:$scope.notice.title,
                    	imgAddress:$scope.notice.imgAddress,
                    	content:$scope.notice.content
                    	},
                    	function(data){
       	   				if(data.code==200){
       	   				$scope.notice={};
       	   				$scope.myAddNoticeForm.$setPristine();
       	   				$scope.$apply();
       	   				myUtils.myLoadingToast("添加成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("添加失败");   	   				
       	   				}
       	   				});
                    };
                    }
                } 
            }
        })
        .state("main.partnerByAcount", {//合伙人信息
            url:"/partnerByAcount/:acountId",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/partner_acount.html",
                    controller:function($rootScope,$scope,$state){
                  	/*
            		*获取参数acountId
            		*/
                    $scope.acountId=$state.params.acountId;
                     if(!$scope.acountId||!myUtils.userVerification.catNum.test($scope.acountId)){
                    $state.go("main.acountList");
                    return;
                    } 
                    /*
            		*获取参数acountId end
            		*/
            	 /*
            *列表
            */
            $scope.acountList=[]; 		
    		$scope.noMore=false;//false还有，true没有更多
    		$scope.totalNumber=0;//总管理员数目
 			$scope.showPageNumberArray=[];//显示页面循环的数组 类似 1,2,3,4,5
			$scope.totalPage=0;//总页数
				
			$scope.currentPage=1;//当前页
			$scope.pageNumber=5;//每页显示数目
			$scope.mostShowPageNumber=5;//设定最多显示页码数目	
			$scope.pagination=myUtils.myPaginationHandler();
			
			//点击哪页显示哪页
			$scope.toPage=function(currentPageNumber,acountId){
			  if($scope.pagination.toPage(currentPageNumber,$scope.currentPage,$scope.totalPage)){
			  //$scope.showNoticeListIcon=true;
			  $scope.currentPage=$scope.pagination.currentPage;
			  $scope.acountListInit(acountId);
			  }
			};
			$scope.acountListInit=function(acountId){
			var acountCountUrl="/acount/count?masterId="+acountId;
			var acountListUrl="/acount/list?masterId="+acountId+"&pageNum="+(($scope.currentPage-1)*$scope.pageNumber+1)+"&pageSize="+$scope.pageNumber;
			  $.get(acountCountUrl,function(cd){
           		$scope.totalNumber=cd;    
           		if($scope.totalNumber==0||$scope.totalNumber==''){
           		$state.go("main.acountList");
           		myUtils.myLoadingToast("没有合伙人")
           		return;
           		}         
           //页码初始化
          $scope.totalPage=$scope.pagination.getTotalPage($scope.totalNumber,$scope.pageNumber);//总页码数目     
          $scope.showPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.mostShowPageNumber,$scope.currentPage);//显示页码数目 
          //所有页码
          $scope.showAllPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.totalPage,$scope.currentPage);
          
        //初始化
  $.get(acountListUrl,function(pld){
           $scope.acountList=pld;
			 console.log($scope.acountList)
			$scope.$apply();
               });
       });
			};
			$scope.acountListInit($scope.acountId);
			
                    }
                } 
            }
        })   
         .state("main.acountList", {//账户列表
            url:"/acountList",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/acount_list.html",
                    controller:function($rootScope,$scope,$state){
                  
            /*
            *列表
            */
            $scope.acountList=[]; 		
    		$scope.noMore=false;//false还有，true没有更多
    		$scope.totalNumber=0;//总管理员数目
 			$scope.showPageNumberArray=[];//显示页面循环的数组 类似 1,2,3,4,5
			$scope.totalPage=0;//总页数
				
			$scope.currentPage=1;//当前页
			$scope.pageNumber=5;//每页显示数目
			$scope.mostShowPageNumber=5;//设定最多显示页码数目	
			$scope.pagination=myUtils.myPaginationHandler();
			 //初始化查询
            $scope.serach={
            acountId:null,
            masterId:null,
            roleId:$rootScope.roleList[0].roleId,
            phone:'',
            nickname:'',
            minScale:0,
            maxScale:1
            };
			
			//点击哪页显示哪页
			$scope.toPage=function(currentPageNumber,serach){
			  if($scope.pagination.toPage(currentPageNumber,$scope.currentPage,$scope.totalPage)){
			  //$scope.showNoticeListIcon=true;
			  $scope.currentPage=$scope.pagination.currentPage;
			  $scope.acountListInit(serach);
			  }
			};
			$scope.acountListInit=function(serach){
			var acountCountUrl="/acount/count";
			var acountListUrl="/acount/list?pageNum="+(($scope.currentPage-1)*$scope.pageNumber+1)+"&pageSize="+$scope.pageNumber;
			var wenhao="&";
			function isExsis(ele){
			wenhao="&";
			if(acountCountUrl.indexOf("count?")<=-1){
			wenhao="?";
			}
			if(serach[ele]){
			acountCountUrl+=wenhao+ele+"="+serach[ele];
			acountListUrl+="&"+ele+"="+serach[ele];
			}
			}
			isExsis("acountId");
			isExsis("masterId");
			isExsis("roleId");
			isExsis("nickname");
			isExsis("phone");
			isExsis("minScale");
			isExsis("maxScale");
			
			  $.get(acountCountUrl,function(cd){
           		$scope.totalNumber=cd;             
           //页码初始化
          $scope.totalPage=$scope.pagination.getTotalPage($scope.totalNumber,$scope.pageNumber);//总页码数目     
          $scope.showPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.mostShowPageNumber,$scope.currentPage);//显示页码数目 
       	  //所有页码
          $scope.showAllPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.totalPage,$scope.currentPage); 
        //初始化
  $.get(acountListUrl,function(pld){
           $scope.acountList=pld;
			$scope.$apply();
               });
       });
			};
			$scope.acountListInit($scope.serach);
			/*
            *列表end
            */
            /*
            *根据角色ID获取列表
            */
            $scope.acountListByRole=function(roleId){
            $scope.serach.nickname='';
            $scope.serach.phone='';
           	$scope.serach.minScale=0;
           	$scope.serach.maxScale=1;
            $scope.serach.roleId=roleId;//设置选择的 角色
            $scope.currentPage=1;//重置
            
            $scope.acountListInit($scope.serach);
            };
            /*
            *根据角色ID获取列表end
            */
			/*
            *合伙人
            */
            $scope.partnerByAcount=function(acount){
            $state.go("main.partnerByAcount",{acountId:acount.acountId});
            };
			/*
            *合伙人end
            */
			/*
            *财务
            */
            $scope.financeByAcount=function(acount){
            $state.go("main.financeByAcount",{acountId:acount.acountId});
            };
			/*
            *财务end
            */
			/*
            *修改
            */
            $scope.updateAcount=function(acount){
            $state.go("main.acountUpdate",{acountId:acount.acountId});
            };
			/*
            *修改end
            */
			/*
            *删除
            */
            $scope.delAcount=function(acount){
            	myUtils.myLoginOut("确定删除吗？", function(){
       				$.get("/acount/delete/acountId="+acount.acountId,function(data){
       					console.log($scope.acountList)
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("删除成功", function(){
       	   				location.reload();
       	   				}); 
       	   				
       	   				}else{
       	   					myUtils.myLoadingToast("删除失败");   	   				
       	   				}
       	   			});
       			});
            };
			/*
            *删除end
            */
          
			/*
            *监听搜索改变
            */
            $scope.controllerScale=function(){
            if($scope.serach.minScale>$scope.serach.maxScale){
            myUtils.myLoadingToast("区间第一格比第二格大");
           $scope.serach.nickname='';
           $scope.serach.minScale=0;
           $scope.serach.maxScale=1;
            }
            };
			/*
            *监听搜索改变end
            */
			/*
            *搜索
            */
            $scope.serachAcountForm=function(){
            $scope.acountListInit($scope.serach);
            };
            
			/*
            *搜索end
            */
			/*
            *初始化合伙人收益比例增量
            */
            $scope.initScaleIncrement=function(){
                    $.get("/scaleIncrement/get",
                    	function(data){
       	   				if(data.code==200){
       	   				$scope.scale={
                    	scaleValue:data.list[0].scaleIncrement
                   		 };
       	   				myUtils.myLoadingToast("获取成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("获取失败");   	   				
       	   				}
       	   				});
                    };
                    $scope.initScaleIncrement();
			/*
            *初始化合伙人收益比例增量end
            */
                    }
                } 
            }
        })
         .state("main.financeByAcount", {//个人财务信息
            url:"/financeByAcount/:acountId",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/acount_finance.html",
                    controller:function($rootScope,$scope,$state){
                  	/*
            		*获取参数acountId
            		*/
                    $scope.financeAcountId=$state.params.acountId;
                    console.log($scope.financeAcountId)
                     if(!$scope.financeAcountId||!myUtils.userVerification.catNum.test($scope.financeAcountId)){
                    $state.go("main.acountList");
                    return;
                    } 
                    /*
            		*获取参数acountId end
            		*/
            		/*
            		*初始化finance
            		*/
                    $scope.financeInit=function(acountId){
                    $.ajax({
                    url:"/finance/list?acountId="+acountId,
                    async:false,
                    success:function(data){
       	   				if(data.code==200){
       	   				$scope.finance=data.list[0];
       	   				$scope.financeId=$scope.finance.financeId;
       	   				myUtils.myLoadingToast("加载成功" ); 
       	   				}else if(data.code==40000&&data.list.length==0){
       	   				$scope.finance=null;
       	   				console.log($scope.finance)
       	   				myUtils.myLoadingToast("加载成功" );
       	   				}else{
       	   					myUtils.myLoadingToast("加载失败");   	   				
       	   				}
       	   			}});
                    };
                    $scope.financeInit($scope.financeAcountId);
                    /*
            		*初始化finance end
            		*/
            		
            /*
            *列表
            */
            $scope.financeDetailsList=[]; 		
    		$scope.noMore=false;//false还有，true没有更多
    		$scope.totalNumber=0;//总管理员数目
 			$scope.showPageNumberArray=[];//显示页面循环的数组 类似 1,2,3,4,5
			$scope.totalPage=0;//总页数
				
			$scope.currentPage=1;//当前页
			$scope.pageNumber=10;//每页显示数目
			$scope.mostShowPageNumber=5;//设定最多显示页码数目	
			$scope.pagination=myUtils.myPaginationHandler();
			
			//点击哪页显示哪页
			$scope.toPage=function(currentPageNumber){
			  if($scope.pagination.toPage(currentPageNumber,$scope.currentPage,$scope.totalPage)){
			  //$scope.showNoticeListIcon=true;
			  $scope.currentPage=$scope.pagination.currentPage;
			  $scope.financeDetailsListInit();
			  }
			};
			$scope.financeDetailsListInit=function(){
			if(!$scope.finance){
			return;}
			  $.get("/financeDetails/count?financeId="+$scope.financeId,function(cd){
           		$scope.totalNumber=cd;    
           //页码初始化
          $scope.totalPage=$scope.pagination.getTotalPage($scope.totalNumber,$scope.pageNumber);//总页码数目     
          $scope.showPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.mostShowPageNumber,$scope.currentPage);//显示页码数目 
          //所有页码
          $scope.showAllPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.totalPage,$scope.currentPage);
          
        //初始化
  $.get("/financeDetails/list?financeId="+$scope.financeId+"&pageNum="+(($scope.currentPage-1)*$scope.pageNumber+1)+"&pageSize="+$scope.pageNumber,function(pld){
           $scope.financeDetailsList=pld;
			 console.log($scope.financeDetailsList)
			$scope.$apply();
               });
       });
			};
			$scope.financeDetailsListInit();
			/*
            *列表end
            */
            
           			/*
            		*财务充值/提现审核 通过
            		*/
                    $scope.financeDetailsStatus=function(financeDetails,model){
                    myUtils.myLoginOut("确定通过吗？", function(){
                     if(model=="审核未通过"){
                    financeDetails.status=model;
                    }else{
                    financeDetails.status=model+"完成";
                    }
                    $.ajax({
                    url:"/financeDetails/update",
                    data:JSON.parse(angular.toJson(financeDetails)),
                    success:function(data){
       	   				if(data.code==200){
       	   				$scope.$apply();
       	   				myUtils.myLoadingToast("更新成功" ); 
       	   				}else{
       	   					myUtils.myLoadingToast("更新失败");   	   				
       	   				}
       	   			}});
       	   			});
                    };
                    $scope.financeInit($scope.financeAcountId);
                    /*
            		*财务充值/提现审核 通过 end
            		*/
            		
                    }
                } 
            }
        })
         .state("main.acountUpdate", {//账户更新
            url:"/acountUpdate/:acountId",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/acount_update.html",
                    controller:function($rootScope,$scope,$state){
                  	/*
            		*获取参数acountId
            		*/
                    $scope.updateAcountId=$state.params.acountId;
                    console.log($scope.updateAcountId)
                     if(!$scope.updateAcountId||!myUtils.userVerification.catNum.test($scope.updateAcountId)){
                    $state.go("main.acountList");
                    return;
                    } 
                    /*
            		*获取参数acountId end
            		*/
            		/*
            		*初始化acount
            		*/
                    $scope.updateInit=function(acountId){
                    $.get("/acount/"+acountId,function(data){
       	   				if(data.code==200){
       	   				$scope.acount=data.list[0];
       	   				$scope.$apply();
       	   				myUtils.myLoadingToast("加载成功" ); 
       	   				}else{
       	   					myUtils.myLoadingToast("加载失败");   	   				
       	   				}
       	   			});
                    };
                    $scope.updateInit($scope.updateAcountId);
                    /*
            		*初始化acount end
            		*/
            		/*
            		*修改acount提交
            		*/
            		$scope.updateAcountForm=function(){
            		$.post("/acount/update",
                    	/* {
                    	noticeId:$scope.notice.noticeId,
                    	title:$scope.notice.title,
                    	content:$scope.notice.content,
                    	createDate:$scope.notice.createDate
                    	}, */
                    	JSON.parse(angular.toJson($scope.acount)),
                    	function(data){
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("修改成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("修改失败");   	   				
       	   				}
       	   				});
            		};
            		/*
            		*修改acount提交 end
            		*/
                    }
                } 
            }
        })
         .state("main.financeData", {//财务数据
            url:"/financeData",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/finance_data.html",
                    controller:function($rootScope,$scope,$state){
                   console.log(111)
                   $scope.fcms=['200','500','1000','2000','3000','5000','10000','30000','50000','80000','100000'];
                   $scope.financeMoneyModel='3000';
                   console.log($scope.financeMoneyModel)
                   $scope.initFinanceCount=function(value){
                   $.get("/finance/count?money="+value,
                    	function(data){
                   $scope.financeCountByMoney=data;
       	   				$scope.$apply();
       	   				//console.log($scope.fcms)
       	   				//console.log($scope.financeMoneyModel)
       	   				});
                   };
                   $scope.initFinanceCount($scope.financeMoneyModel);
                   //财务总数据
                   $scope.initFinanceData=function(){
                   $.get("/finance/data",
                    	function(data){
                   $scope.financeData=data.list[0];
       	   				$scope.$apply();
       	   				});
                   };
                   $scope.initFinanceData();
            }
            }
            }
        })
         .state("main.acountAdd", {//账户增加
            url:"/acountAdd",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/acount_add.html",
                    controller:function($rootScope,$scope,$state){
                    $scope.addAcountForm=function(){
                    	$.post("/acount/add",
                    	/* {
                    	title:$scope.notice.title,
                    	content:$scope.notice.content
                    	}, */
                    	JSON.parse(angular.toJson($scope.acount)),
                    	function(data){
       	   				if(data.code==200){
       	   				$scope.acount={};
       	   				$scope.myAddAcountForm.$setPristine();
       	   				$scope.$apply();
       	   				myUtils.myLoadingToast("添加成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("添加失败");   	   				
       	   				}
       	   				});
                    };
                    }
                } 
            }
        })
        .state("main.jsAd", {//js广告
            url:"/jsAd",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/js_ad.html",
                    controller:function($rootScope,$scope,$state){
                    $scope.jsAd={
                    score:1,
                    value:'',
                    }
                    $scope.jsAdList=[];
                    //初始化
                    $scope.initJsAd=function(){
                    $.get("/jsAd/list",
                    	function(data){
       	   				if(data.code==200){
       	   				  $scope.jsAdList=data.list//默认
                    
                    $scope.$apply();
       	   				myUtils.myLoadingToast("获取成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("获取失败");   	   				
       	   				}
       	   				});
                    };
                    $scope.initJsAd();
                    //增加
            	 $scope.addJsAdForm=function(){
                    	$.post("/jsAd/add",
                    	{
                    	//score:$scope.domain.score,
                    	value:$scope.jsAd.value
                    	},
                    	function(data){
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("增加成功");
       	   				$scope.initJsAd();
       	   				}else{
       	   					myUtils.myLoadingToast("修改失败");   	   				
       	   				}
       	   				});
                    };
                    //删除
                     $scope.delJsAd=function(jsAd){
            	myUtils.myLoginOut("确定删除吗？", function(){
       				$.get("/jsAd/del",
       				{value:jsAd},
       				function(data){
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("删除成功", function(){
       	   				$scope.initJsAd();
       	   				}); 
       	   				
       	   				}else{
       	   					myUtils.myLoadingToast("删除失败");   	   				
       	   				}
       	   			});
       			});
            };
                    }
                } 
            }
        }).state("main.spreadList", {//推广列表
            url:"/spreadList",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/spread_list.html",
                    controller:function($rootScope,$scope,$state){
                  
            /*
            *列表
            */
            $scope.spreadList=[]; 		
    		$scope.noMore=false;//false还有，true没有更多
    		$scope.totalNumber=0;//总管理员数目
 			$scope.showPageNumberArray=[];//显示页面循环的数组 类似 1,2,3,4,5
			$scope.totalPage=0;//总页数
				
			$scope.currentPage=1;//当前页
			$scope.pageNumber=10;//每页显示数目
			$scope.mostShowPageNumber=5;//设定最多显示页码数目	
			$scope.pagination=myUtils.myPaginationHandler();
			//初始化请求
			$scope.platform='';
			$scope.status='正常';
			
			//点击哪页显示哪页
			$scope.toPage=function(currentPageNumber,platform,status){
			  if($scope.pagination.toPage(currentPageNumber,$scope.currentPage,$scope.totalPage)){
			  //$scope.showNoticeListIcon=true;
			  $scope.currentPage=$scope.pagination.currentPage;
			  $scope.spreadListInit(platform,status);
			  }
			};
			$scope.spreadListInit=function(platform,status){
			  $.get("/spread/count?platform="+platform+"&status="+status,function(cd){
           		$scope.totalNumber=cd;             
           //页码初始化
          $scope.totalPage=$scope.pagination.getTotalPage($scope.totalNumber,$scope.pageNumber);//总页码数目     
          $scope.showPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.mostShowPageNumber,$scope.currentPage);//显示页码数目 
          //所有页码
          $scope.showAllPageNumberArray=$scope.pagination.getShowPageNumber($scope.totalPage,$scope.pageNumber,$scope.totalPage,$scope.currentPage);
          
        //初始化
  $.get("/spread/list?platform="+platform+"&status="+status+"&pageNum="+(($scope.currentPage-1)*$scope.pageNumber+1)+"&pageSize="+$scope.pageNumber,function(pld){
           $scope.spreadList=pld;
			 console.log($scope.spreadList)
			$scope.$apply();
               });
       });
			};
			$scope.spreadListInit($scope.platform,$scope.status);
			/*
            *列表end
            */
			/*
            *删除
            */
            $scope.delSpread=function(spread){
            	myUtils.myLoginOut("确定删除吗？", function(){
       				$.get("/spread/delete?spreadId="+spread.spreadId,function(data){
       					console.log($scope.spread)
       	   				if(data.code==200){
       	   				myUtils.myLoadingToast("删除成功", function(){
       	   				$scope.spreadListInit();
       	   				}); 
       	   				
       	   				}else{
       	   					myUtils.myLoadingToast("删除失败");   	   				
       	   				}
       	   			});
       			});
            };
			/*
            *删除end
            */
			/*
            *根据平台查询
            */
            $scope.spreadListByPlatform=function(platform,status){
            $scope.platform=platform;
            $scope.status=status;
            	$scope.spreadListInit(platform,status);
            };
			/*
            *根据平台查询end
            */
                    }
                } 
            }
        })
         .state("main.spreadAdd", {//推广增加
            url:"/spreadAdd",
            views: {
            	'rightbody@main': {
                    templateUrl: "/seller/templates/spread_add.html",
                    controller:function($rootScope,$scope,$state){
				    $scope.spread={
				    platform:0,
				    model:0,
				    name:'',
				    link:'',
				    content:'',
				   	unitPrice:0.2,
				    totalPrice:200000
				    };
                     
                     //表单提交
                    $scope.addSpreadForm=function(){
                    	$.ajax({
						  url: "/spread/add",
						  type: 'POST',
						  data: $scope.spread,
						  success: function(data){
						  if(data.code==200){
       	   			 $scope.spread={
				    platform:0,
				    model:0,
				    name:'',
				    link:'',
				    content:'',
				   	unitPrice:0.2,
				    totalPrice:200000
				    };
       	   				$scope.myAddSpreadForm.$setPristine();
       	   				$scope.$apply();
       	   				myUtils.myLoadingToast("添加成功"); 
       	   				}else{
       	   					myUtils.myLoadingToast("添加失败");   	   				
       	   				}
						  },
						  error: function(){
						  myUtils.myLoadingToast("添加失败"); 
						  }
						});
                    };
                    
                    
                    }
                } 
            }
        }); 
		});	
		</script>
		<!-- 配置 js -->
		<script type="text/javascript" src="/seller/templates/configuration/configuration.js"></script>
		<!-- 物品 js -->
		<script type="text/javascript" src="/seller/templates/goods/goods.js"></script>
		<!--  js -->
		<script type="text/javascript" src="/seller/templates/recharge/recharge.js"></script>
        </body>
</html>